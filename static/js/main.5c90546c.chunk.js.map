{"version":3,"sources":["components/Upload.jsx","lib/getTxt.js","components/App.jsx","lib/download.js","lib/encode.js","reportWebVitals.js","index.js","components/App.module.css"],"names":["UploadFile","handleRead","useState","file","setFile","props","onRemove","beforeUpload","type","message","error","fileList","icon","UploadOutlined","getTxt","data","txt","regExp","push","filter","i","map","item","code","price","name","toString","substring","replace","toFixed","length","App","setData","reader","FileReader","rABS","readAsBinaryString","onload","e","bstr","target","result","wb","XLSX","read","wsname","SheetNames","ws","Sheets","utils","sheet_to_json","header","downloadClick","xlsxURL","window","URL","createObjectURL","Blob","join","tempLink","document","createElement","href","setAttribute","string","encodeChar","c","h","test","indexOf","charCodeAt","res","charAt","encodeCP1251","click","download","className","style","main","buttons","onClick","disabled","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","module","exports"],"mappings":"gOAMaA,EAAa,SAAC,GAAoB,IAAlBC,EAAiB,EAAjBA,WAC3B,EAAwBC,mBAAS,IAAjC,mBAAOC,EAAP,KAAaC,EAAb,KAEMC,EAAQ,CACZC,SAAU,WACRF,EAAQ,KAGVG,aAAc,SAACJ,GAEG,aAAdA,EAAKK,MAEH,sEADFL,EAAKK,MAILC,IAAQC,MAAM,iJAGhBN,EAAQ,CAACD,IACTF,EAAWE,KAIf,OACE,cAAC,IAAD,2BAAYE,GAAZ,IAAmBM,SAAUR,EAA7B,SACE,cAAC,IAAD,CAAQS,KAAM,cAACC,EAAA,EAAD,IAAd,wBC/BOC,EAAS,SAACC,GACrB,IAAIC,EAAM,GAEV,IAAKD,EACH,OAAO,KAGT,IAAME,EAAS,qCA2Df,OAfAD,EAAIE,KAAK,mIACTF,EAAIE,KAAK,mBAETH,EACGI,QAAO,SAACC,GAAD,OAAOA,EAAE,MAChBC,KAAI,SAACC,GA/CQ,IAACC,EAgBCC,EAJDC,EA0Cb,OANAT,EAAIE,KAAJ,YACOI,EAAK,GAAGI,WADf,cApCaD,EAqCyBH,EAAK,GApC7C,OAAOG,QAAP,IAAOA,OAAP,EAAOA,EAAME,UAAU,EAAG,IAAIC,QAAQX,EAAQ,MAmC5C,eAhCcO,EAkCVF,EAAK,GAlCI,OAAWE,QAAX,IAAWA,OAAX,EAAWA,EAAOK,QAAQ,GAAGH,WAAWE,QAAQ,IAAK,MAgClE,mBAhDaL,EAmDQD,EAAK,KAlDhBC,EAAKO,OAAS,GAAKP,EAAKO,QAAU,GACrCP,EAGLA,GAAQA,EAAKO,OAAS,GACjBP,EAAKI,UAAU,EAAG,IAGpB,EAuCL,sBAMO,QAGL,GAAN,OAAWX,I,iBCnDAe,G,OAAM,WACjB,MAAwB7B,mBAAS,IAAjC,mBAAOa,EAAP,KAAaiB,EAAb,KAEMC,EAAS,IAAIC,WAEbC,IAASF,EAAOG,mBAEtBH,EAAOI,OAAS,SAACC,GACf,IAAMC,EAAOD,EAAEE,OAAOC,OAChBC,EAAKC,IAAKC,KAAKL,EAAM,CAAE/B,KAAM2B,EAAO,SAAW,UAC/CU,EAASH,EAAGI,WAAW,GACvBC,EAAKL,EAAGM,OAAOH,GACf9B,EAAO4B,IAAKM,MAAMC,cAAcH,EAAI,CACxCI,OAAQ,IAEVnB,EAAQlB,EAAOC,KAGjB,IAIMqC,EAAgB,SAACrC,ICnCD,SAACC,GACvB,IAAIqC,EAAUC,OAAOC,IAAIC,gBACvB,IAAIC,KAAK,CAAC,CAACzC,EAAI0C,KAAK,UAAW,CAC7BlD,KAAM,iBAGNmD,EAAWC,SAASC,cAAc,KACtCF,EAASG,KAAOT,EAChBM,EAASI,aACP,OACA,mCCZwB,SAACC,GAC3B,SAASC,EAAWC,GAClB,IAUIC,GATK,mBAASC,KAOJF,GAHZ,+tBAGwBG,QAAQH,GAAK,IAAMA,EAAEI,WAAW,IAEhD5C,SAAS,IAMnB,MAJU,MAANyC,IACFA,EAAI,MAGC,IAAMA,EAKf,IAFA,IAAII,EAAM,GAEDnD,EAAI,EAAGA,EAAI4C,EAAOlC,OAAQV,IACjCmD,GAAON,EAAWD,EAAOQ,OAAOpD,IAGlC,OAAOmD,EDfgCE,CAAazD,EAAI0C,KAAK,QAE7DC,EAASI,aAAa,WAAY,cAClCJ,EAASe,QDuBPC,CAAS5D,IAGX,OACE,sBAAK6D,UAAWC,IAAMC,KAAtB,UACE,cAAC,IAAD,CACErE,QACE,yFAEE,mBAAGqD,KAAK,6DAA+Ba,UAAQ,EAA/C,kDAFF,4FAQFnE,KAAK,SAGP,sBAAKoE,UAAWC,IAAME,QAAtB,UACE,cAAC,EAAD,CAAY9E,WAxBC,SAACE,GAClB8B,EAAOG,mBAAmBjC,MAyBtB,cAAC,IAAD,CACEK,KAAK,UACLwE,QAAS,kBAAM5B,EAAcrC,IAC7BkE,SAA0B,IAAhBlE,EAAKe,OAHjB,gEG/COoD,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCFdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFjC,SAASkC,eAAe,SAM1BZ,K,mBCdAa,EAAOC,QAAU,CAAC,KAAO,kBAAkB,QAAU,uB","file":"static/js/main.5c90546c.chunk.js","sourcesContent":["import { useState } from \"react\";\n\n//componetns\nimport { Button, Upload, message } from \"antd\";\nimport { UploadOutlined } from \"@ant-design/icons\";\n\nexport const UploadFile = ({ handleRead }) => {\n  const [file, setFile] = useState([]);\n\n  const props = {\n    onRemove: () => {\n      setFile([]);\n    },\n\n    beforeUpload: (file) => {\n      const isCsvOrXlsx =\n        file.type === \"text/csv\" ||\n        file.type ===\n          \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n\n      if (!isCsvOrXlsx) {\n        message.error(\"Не правильный формат файла\");\n      }\n\n      setFile([file]);\n      handleRead(file);\n    },\n  };\n\n  return (\n    <Upload {...props} fileList={file}>\n      <Button icon={<UploadOutlined />}>Upload</Button>\n    </Upload>\n  );\n};\n","export const getTxt = (data) => {\n  let txt = [];\n\n  if (!data) {\n    return null;\n  }\n\n  const regExp = /[^a-zа-яё0-9,.\\s]/gi;\n\n  const getCode = (code) => {\n    if (code && code.length > 0 && code.length <= 13) {\n      return code;\n    }\n\n    if (code && code.length > 13) {\n      return code.substring(0, 13);\n    }\n\n    return 0;\n  };\n\n  const getName = (name) => {\n    return name?.substring(0, 27).replace(regExp, \" \");\n  };\n\n  const getPrice = (price) => price?.toFixed(3).toString().replace(\".\", \",\");\n\n  /*\n  data\n    .filter((i) => i[0])\n    .map((item) => {\n      txt.push(\n        `${item[0].toString().padStart(4, \"0\")}.0001=\"${getName(item[1])}\"`\n      ); //наименование\n      txt.push(\n        `${item[0].toString().padStart(4, \"0\")}.0002=\"${item[2]\n          ?.toString()\n          .replace(\".\", \",\")}\"`\n      ); //цена товара\n      txt.push(`${item[0].toString().padStart(4, \"0\")}.0003=\"1\"`);\n      txt.push(\n        `${item[0].toString().padStart(4, \"0\")}.0004=\"${getCode(item[3])}\"`\n      ); //штрих код\n      txt.push(`${item[0].toString().padStart(4, \"0\")}.0005=\"0,000\"`);\n      txt.push(`${item[0].toString().padStart(4, \"0\")}.0006=\"0,000\"`);\n\n      return null;\n    });\n\n    */\n\n  txt.push(\"1;1;П №1;П №2;П №3;П №4;[??] Поле 5;[??] Поле 6\");\n  txt.push(\"1;1;1;0;0;0;0;0\");\n\n  data\n    .filter((i) => i[0])\n    .map((item) => {\n      txt.push(\n        `1;${item[0].toString()};\"${getName(item[1])}\";\"${getPrice(\n          item[2]\n        )}\";\"1\";\"${getCode(item[3])}\";\"0,000\";\"0,000\"`\n      );\n\n      return null;\n    });\n\n  return [...txt];\n};\n","import { useState } from \"react\";\nimport XLSX from \"xlsx\";\n\n//components\nimport { Alert, Button } from \"antd\";\nimport { UploadFile } from \"./Upload\";\n\n//utils\nimport { download } from \"../lib/download\";\nimport { getTxt } from \"../lib/getTxt\";\n\n//style\nimport style from \"./App.module.css\";\nimport \"antd/dist/antd.css\";\n\nexport const App = () => {\n  const [data, setData] = useState([]);\n\n  const reader = new FileReader();\n\n  const rABS = !!reader.readAsBinaryString;\n\n  reader.onload = (e) => {\n    const bstr = e.target.result;\n    const wb = XLSX.read(bstr, { type: rABS ? \"binary\" : \"array\" });\n    const wsname = wb.SheetNames[0];\n    const ws = wb.Sheets[wsname];\n    const data = XLSX.utils.sheet_to_json(ws, {\n      header: 1,\n    });\n    setData(getTxt(data));\n  };\n\n  const handleRead = (file) => {\n    reader.readAsBinaryString(file);\n  };\n\n  const downloadClick = (data) => {\n    download(data);\n  };\n\n  return (\n    <div className={style.main}>\n      <Alert\n        message={\n          <span>\n            Скачайте &nbsp;\n            <a href=\"/elves/templates/шаблон.xlsx\" download>\n              шаблон\n            </a>\n            &nbsp; и заполните его.\n          </span>\n        }\n        type=\"info\"\n      />\n\n      <div className={style.buttons}>\n        <UploadFile handleRead={handleRead} />\n\n        <Button\n          type=\"primary\"\n          onClick={() => downloadClick(data)}\n          disabled={data.length === 0}\n        >\n          Скачать\n        </Button>\n      </div>\n    </div>\n  );\n};\n","import { encodeCP1251 } from \"./encode\";\n\nexport const download = (txt) => {\n  let xlsxURL = window.URL.createObjectURL(\n    new Blob([[txt.join(\"\\r\\n\")]], {\n      type: \"text/x-csrc\",\n    })\n  );\n  let tempLink = document.createElement(\"a\");\n  tempLink.href = xlsxURL;\n  tempLink.setAttribute(\n    \"href\",\n    \"data:text/x-csrc;charset=cp1251,\" + encodeCP1251(txt.join(\"\\n\"))\n  );\n  tempLink.setAttribute(\"download\", \"elves.csv2\");\n  tempLink.click();\n};\n","export const encodeCP1251 = (string) => {\n  function encodeChar(c) {\n    let isKyr = function (str) {\n      return /[а-я]/i.test(str);\n    };\n\n    let cp1251 =\n      \"ЂЃ‚ѓ„…†‡€‰Љ‹ЊЌЋЏђ‘’“”•–—�™љ›њќћџ ЎўЈ¤Ґ¦§Ё©Є«¬*®Ї°±Ііґµ¶·\\\nё№є»јЅѕїАБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдежзийклмнопрстуфхцчшщъыьэюя\";\n\n    let p = isKyr(c) ? cp1251.indexOf(c) + 128 : c.charCodeAt(0);\n\n    let h = p.toString(16);\n\n    if (h === \"a\") {\n      h = \"0A\";\n    }\n\n    return \"%\" + h;\n  }\n\n  let res = \"\";\n\n  for (let i = 0; i < string.length; i++) {\n    res += encodeChar(string.charAt(i)); //ну или string[i]\n  }\n\n  return res;\n};\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { App } from \"./components/App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"App_main__jNC5T\",\"buttons\":\"App_buttons__3GWl1\"};"],"sourceRoot":""}